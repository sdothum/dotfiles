#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Hardware
# ══════════════════════════════════════════════════════════════════════════════

# ........................................................... Display brightness

usage() { usage: "$(basename $0) [+-]<percent>"; exit 1; }

LEVEL=$SESSION/brightness
min=20
max=100

brightness() {
	xrandr --output HDMI-0 --brightness $(echo "scale=2; ${1} / 100" | bc)
	echo ${1} >$LEVEL
	notify brightness "${1}%"
}

[ -e $LEVEL ] && level=$(cat $LEVEL)
[ $level ] || level=100

[ $1 ] && { echo $1 | grep -q '^[+-]*[0-9]*$' || usage; }

case $1 in
	'' ) ;;
	-* ) level=$(( level + $1 )); [ $level -lt $min ] && level=$min ;;
	+* ) level=$(( level + $1 )); [ $level -gt $max ] && level=$max ;;
	*  ) level=$1 ;;
esac

brightness $level

# kak: filetype=sh
