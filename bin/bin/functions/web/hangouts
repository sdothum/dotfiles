#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Web
# ══════════════════════════════════════════════════════════════════════════════

# .............................................................. Google hangouts

HANGOUTS=$SESSION/hangouts

case $BROWSER in
	luakit) luakit $(cat $HANGOUTS) & ;;
	surf  ) surf -z1.15 -C $(dirname $0)/.hangouts:stylesheet.css $(cat $HANGOUTS) & ;;
	*     ) /usr/bin/qutebrowser --target tab --override-restore  $(cat $HANGOUTS) & ;;
esac

xsync 'Gmail'

if [ $BROWSER = qutebrowser ] ;then
	if [ -e $HLWM:hangouts ] ;then
		keyboard off  # disable keyboard to prevent disrupting following :command
		sleep 2       # pause long enough for window focus
		xdotool key 'Y'
		keyboard on   # enable keyboard
	else
		# xdotool ineffective on initial qutebrowser launch
		notify critical 'MESSAGE \ hangouts' '"Permission request" response required'
		touch $HLWM:hangouts
	fi
fi

# vim: set ft=sh: #
